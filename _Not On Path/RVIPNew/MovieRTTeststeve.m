function[yes,nos,mids,prems] = MovieRTTest(window,ClipNum,filename,movie,port)port=psychserial('open', '.Bin', '.BOut', 19200);filename = ['Jenny S2:Desktop Folder:Library Ex5:ANDY:' int2str(ClipNum) '.mov'];% show the moviemovie=Showtime('GetFromFile',filename);Showtime('LoadIntoRam',movie);Showtime('Window',movie,window);while(~isempty(a))a= psychserial('read', port, 0.001);endprems=[];%frate=showtime('Rate',movie);tbetweenframes=0.04;%1/frate;nos=[];yes=[];mids=[];for i=1:250 	prems=[prems getsecs]; 	t=getsecs;	Showtime('MovieFrameDisplay',movie,i);	while((getsecs-t)<tbetweenframes) 	a = uint8(psychserial('read', port,0.0001));	if(~isempty(a))				if(a(1)==4)			yes=[yes getsecs];	    elseif(a(1)==1)			nos=[nos getsecs];		elseif(a(1)==2)			mids=[mids getsecs];		end	end	endendtend=getsecs;psychserial('close', port);Showtime('Dispose',movie);yes-prems(1)noos=nos-prems(1)midl=mids-prems(1)tlen=tend-prems(1)