function[nos,prems,out] = MovieRTTest(ClipNum)port=psychserial('open', '.Bin', '.BOut', 19200);%a0=psychserial('read', port,0.020);%SCREEN(window,'DrawText','Press button box to start the test',400,50,black);filename = ['Macintosh HD:Desktop Folder:Experiments:Library Ex5:Andy:Clip' int2str(ClipNum) '.mov'];%filename = ['Macintosh HD:Desktop Folder:trial14.mov'];% show the moviemovie=Showtime('GetFromFile',filename);Showtime('LoadIntoRam',movie);%keyboardwindow=Showtime('OpenWindow',0);Showtime('Window',movie,window);gray=GrayIndex(window,0.5);Screen(window,'FillRect',gray);a= psychserial('read', port, 0.001);while(~isempty(a))a= psychserial('read', port, 0.001);endwhile(isempty(a))a= psychserial('read', port, 0.001);endwhile(~isempty(a))a= psychserial('read', port, 0.001);endprems=[];postms=[];frate=showtime('Rate',movie);tbetweenframes=1/frate;nos=[];out=[];mids=[];for i=1:250	prems=[prems getsecs];  	t=getsecs;	Showtime('MovieFrameDisplay',movie,i);	while((getsecs-t)<tbetweenframes) 	%	while(~SCREEN(window,'WaitBlanking'));%	framesSinceLastWait=SCREEN(window,'WaitBlanking');	a = uint8(psychserial('read', port,0.0001));	if(~isempty(a))		%		is=ismember(double(a),[1 2 4]);%			out=[out getsecs a(is) -1];%		end			%		a		if(a(1)==4)			out=[out getsecs];	    elseif(a(1)==1)			nos=[nos getsecs];		elseif(a(1)==2)			mids=[mids getsecs];		end	end	endendtend=getsecs;Showtime('CloseWindow',window);psychserial('close', port);Showtime('Dispose',movie);%yess=out-prems(1)outnoos=nos-prems(1)midl=mids-prems(1)tlen=tend-prems(1)