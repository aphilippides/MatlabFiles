function WriteSPSSFilesflag=1;while(flag)    s=input('Enter number of minutes per trial and press return\n(default=6: just press return)\n');    flag=0;    if(isempty(s)) NumMins=6;    elseif(isnumeric(s)) NumMins=floor(s);    else flag=1;    endendFList=GetFileNameList;if(FList==-1)   return; end;cd('Macintosh HD:Desktop Folder:Miscellaneous:RVIPFiles:RVIPData');f=input('Enter filename\n','s');filename1 = [f '.sav']filename2 = [f '.xls']while(IsFile(filename1))    a=input('Filename in use. Do you want to over write [y/n]\n','s');    if((a=='y')|(a=='Y')) break;     else         f=input('Enter new filename\n','s');        filename1 = [f '.sav']        filename2 = [f '.xls']    endend;fid1=fopen(filename1,'w');fid2=fopen(filename2,'w');WritePreamble(NumMins,fid2);for i=1:size(FList,1)    fn=deblank(FList(i,:));	[D,F]=GetDirName(fn);	cd(D);    a=GetRTNums(F);	cd ..    fprintf(fid1,'%s\t%s\t',D,F);    fprintf(fid2,'%s\t%s\t',D,F);        if(isempty(a))        for j=1:2*NumMins           fprintf(fid1,' \t');          fprintf(fid2,' \t');        end    else        for j=1:2*NumMins           fprintf(fid1,'%d\t',a(j));           fprintf(fid2,'%d\t',a(j));        end    end        if(isempty(a))        for j=1:NumMins           fprintf(fid1,' \t');          fprintf(fid2,' \t');        end    else        for j=1:NumMins           fprintf(fid1,'%1.4f\t',a(j+2*NumMins));           fprintf(fid2,'%1.4f\t',a(j+2*NumMins));        end   end   fprintf(fid1,'\n');   fprintf(fid2,'\n');endfclose(fid1);fclose(fid2);function[FList]=GetFileNameListcd('Macintosh HD:Desktop Folder:Miscellaneous:RVIPFiles:RVIPData:');DList=dir;DirInds=[];for i=1:length(DList)	if((~strcmp(DList(i).name,'Selected'))&(DList(i).isdir))		DirInds=[DirInds i];	endendfprintf('\n\nFolders selected are:\n\n')for j=1:length(DirInds)	fprintf('%s\n',DList(DirInds(j)).name);endDInds=DirInds;flaggy=0;for i=1:length(DInds)	a='c';	while((a~='y')&(a~='n'))		a=input(['Do you want the files in folder ' DList(DInds(i)).name '?\nPress y/n followed by return\npress return to select them all\n'],'s');        if(isempty(a))			flaggy=1;			break;		end	end	if(flaggy==1) break;end	if(a=='n') 		DirInds=setdiff(DirInds,DInds(i)); 		fprintf('\n\nFolders selected are:\n\n')		for j=1:length(DirInds)			fprintf('%s\n',DList(DirInds(j)).name);		end	endendfns=[];for i=1:length(DirInds)	[o,fs]=IsFile('*.dat',DList(DirInds(i)).name);	fns=strvcat(fns,fs);endfns=SortByDate(fns);if(isempty(fns))     a=input('No data files in this directory. Press return to exit');    FList=-1;    return;endflag=1;NumOnLine=5;FList=[];while(flag)	fprintf('\n\nFiles selected are:\n\n')%	fns=SortByDate(fns);	WriteFilesOnScreen(FList,NumOnLine)	 fprintf('\n\nFiles to be selected are:\n\n')    WriteFilesOnScreen(fns,NumOnLine)     fprintf('\n');    a=input('\nSelect files which will be included in SPSS file\nType the name of the file without the ''.dat'' extension followed by enter.\n\nLorraine: are filenames unique??\n\nType enter on its own to continue\n','s');     if(isempty(a)) break; end	for i=1:length(DirInds)		[o,f]=IsFile([DList(DirInds(i)).name ':' a '.dat']);		if(o) 			[fns,in] = DeleteFileIsFile(fns,f(2:end));				FList=strvcat(FList,f(2:end));		end	endend%FList=fns;function[n]=GetRTNums(fn)if(IsFile(fn))    h=load(fn,'-ascii')';    n=[h(2,:) h(3,:) h(4,:)];else    n=[];endfunction[f]=SortByDate(f)for i=1:size(f,1)	s=dir(deblank(f(i,:)));	dates(i)=datenum(s.date);end[sd,i]=sort(dates);f=f(i,:);function[D,Fn]=GetDirName(fn)for i=1:length(fn)	if fn(i)==':' break;end;endD=fn(1:i);Fn=fn(i+1:end);function WriteFilesOnScreen(fns,NumOnLine)if isempty(fns) return; endL=size(fns,1);N=fix(L/NumOnLine)-1;M=rem(L,NumOnLine);for i=0:N    for j=1:NumOnLine        fprintf('%s ',fns(i*NumOnLine+j,:));    end    fprintf('\n');endfor i=1:M    fprintf('%s ',fns((N+1)*NumOnLine+i,:));endfunction WritePreamble(NumMins,fid)%fprintf(fid,'subno\tfilename\t ');fprintf(fid,'Directory\t');fprintf(fid,'Filename\t');for i=1:NumMins fprintf(fid,'Hits Min %d\t',i); endfor i=1:NumMins fprintf(fid,'Misses Min %d\t',i); endfor i=1:NumMins fprintf(fid,'Mean RT Min %d\t',i); endfprintf(fid,'\n');